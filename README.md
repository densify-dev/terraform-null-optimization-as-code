<img src="https://www.densify.com/wp-content/uploads/densify.png" width="300">

# Densify
Module to provide an interface between Densify machine learning analytics and Terraform templates, enabling auto-tagging of cloud instances and containers based on Densify's optimization analysis (making them “self-aware”), and automated optimization of instance families, sizes, and resource requests/limits (making them “self-optimizing”).  

This interface is based on densify.auto.tfvars, which is automatically generated by Densify, and contains operational intelligence, analysis findings, and optimization recommendations for each cloud instance or container in scope. This module unpacks the data in this structure and makes it available in Terraform as variables, enabling precise specification of resources to optimally match the learned patterns of behaviour. This provides next-generation resource optimization and eliminates hard-coded resource specifications.

- [Requirements](#requirements)
- [Usage](#usage)
- [Examples](#examples)
- [Inputs](#inputs)
- [Outputs](#outputs)
- [License](#license)

## Requirements
- Densify account, which is provided with a Densify subscription or free trial (www.densify.com/trial)


## Usage

```hcl
module "densify" {
  source  = "kgillan/densify/null"

  densify_recommendations = "${var.densify_recommendations}"
  densify_default = "${var.densify_default}"
  densify_terraform_id = "${var.name}"
}
```
## Examples


## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|:----:|:-----:|:-----:|
| densify_recommendations | Map of maps that contains the recommendations from Densify | Map | - | Yes |
| densify_default | Default values to use if the system is not found in the results from Densify | Map | - | Yes |
| densify_terraform_id | System identifier to uniquely identify which system is being updated | String | - | Yes |

## Outputs

| Name | Description |
|------|-------------|
| Current_type | Current instance size |
| recommended_type | Densify recommended instance size |
| savings_estimate | The potential monthly savings from modifying the current instance to the Densify recommended instance |
| predicted_uptime | The predicted percentage of CPU utilization hours over the duration of a month |
| recommend_ri_coverage | Densify recommends purchasing reserved instance coverage for this instance |
| current_cpu_request | Current CPU request for Kubernetes |
| recommended_cpu_request | Recommended CPU request for Kubernetes |
| current_cpu_limit | Current CPU limit for Kukbernetes |
| recommended_cpu_limit | Recommended CPU limit for Kubernetes |
| current_mem_request | Current memory request for Kubernetes |
| recommended_mem_request | Recommended memory request for Kubernetes |
| current_mem_limit | Current memory limit for Kubernetes |
| recommended_mem_limit | Recommended memory limit for Kubernetes |
| approved_instance_type | The resulting instance size for implementation based on the recommended or current size with Densify self-optimize policy and approval settings applied |
| cpu_request | The resulting CPU request for implementation based on the recommended or current size with Densify self-optimize policy and approval settings applied |
| cpu_limit | The resulting CPU limit for implementation based on the recommended or current size with Densify self-optimize policy and approval settings applied |
| mem_request | The resulting memory request for implementation based on the recommended or current size with Densify self-optimize policy and approval settings applied |
| mem_limit | The resulting memory limit for implementation based on the recommended or current size with Densify self-optimize policy and approval settings applied |

## License

Apache 2 Licensed. See LICENSE for full details.
